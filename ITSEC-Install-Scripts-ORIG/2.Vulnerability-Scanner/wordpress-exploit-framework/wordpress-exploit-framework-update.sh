#!/bin/bash

#1i
. /opt/ownsec/ITSEC-Install-Scripts-ORIG/001.functions/all-scripts.sh

GITREPO=https://github.com/rastating/wordpress-exploit-framework
BRANCH=master
GITREPOROOT=/opt/ITSEC/2.Vulnerability-Scanner/wordpress-exploit-framework/rastating/wordpress-exploit-framework
GITCONFDIR=/opt/ITSEC/2.Vulnerability-Scanner/wordpress-exploit-framework/rastating/wordpress-exploit-framework
GITREPOBINDIR=/opt/ITSEC/2.Vulnerability-Scanner/wordpress-exploit-framework/rastating/wordpress-exploit-framework/bin
GITCLONEDIR=/opt/ITSEC/2.Vulnerability-Scanner/wordpress-exploit-framework/rastating
EXECUTEABLE1=wpxf.sh 
EXECUTEABLE2=wordpress-exploit-framework
#ph1b
DSKTPFLS=/opt/ownsec/ITSEC-Install-Scripts-ORIG/2.Vulnerability-Scanner/wordpress-exploit-framework
DSKTPFLSDEST=/home/$USER/.local/share/applications/2.Vulnerability-Scanner/wordpress-exploit-framework
DSKTPFL=wordpress-exploit-framework.desktop
APTLSTDIR=/opt/ownsec/ITSEC-Install-Scripts-ORIG/0.Initial/lst/apt
#ph1a

echo "${bold}
__        ______       _______  __     _____ __  ____        ______  _  __
\ \      / /  _ \     | ____\ \/ /    |  ___|  \/  \ \      / /  _ \| |/ /
 \ \ /\ / /| |_) |____|  _|  \  /_____| |_  | |\/| |\ \ /\ / /| |_) | ' / 
  \ V  V / |  __/_____| |___ /  \_____|  _| | |  | | \ V  V / |  _ <| . \ 
   \_/\_/  |_|        |_____/_/\_\    |_|   |_|  |_|  \_/\_/  |_| \_\_|\_\
                                                                                    
UPDATE                                   
${normal}"

GITUPTODATE
if git checkout $BRANCH &&
git fetch origin $BRANCH &&
[ `git rev-list HEAD...origin/$BRANCH --count` != 0 ] &&
git merge origin/$BRANCH
then
    
GITCLONEFUNC

sudo apt-get install build-essential patch
sudo apt-get install ruby-dev zlib1g-dev liblzma-dev

. ~/.bashrc
eval "$(rbenv init -)"
yes "N" | rbenv install 2.4.1 
rbenv rehash
rbenv shell 2.4.1 
sudo updatedb
sudo ldconfig

GITRESET
GITSBMDLINIT
gem install bundler
bundle update
bundle install
#gem uninstall arachni
#gem install arachni
#gem install rake
#cd $GITREPOBINDIR

echo '#!/bin/bash 

cd /opt/ITSEC/2.Vulnerability-Scanner/wordpress-exploit-framework/rastating/wordpress-exploit-framework

source ~/.bashrc
eval "$(rbenv init -)"
rbenv shell 2.4.1
ruby wpxf.rb "$@"
' > $EXECUTEABLE1 

CHMODXEX1

SYMLINKEX2TO1


#333d
CPDESKTFL


fi
