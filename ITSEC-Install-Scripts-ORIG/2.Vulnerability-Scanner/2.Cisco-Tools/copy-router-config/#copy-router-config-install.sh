#!/bin/bash

#1i
. /opt/ownsec/ITSEC-Install-Scripts-ORIG/001.functions/all-scripts.sh

BRANCH=master
GITREPO=https://github.com/gitpan/Cisco-CopyConfig
GITREPOROOT=/opt/ITSEC/2.Vulnerability-Scanner/2.Cisco-Tools/copy-router-config/foreni-packages/copy-router-config
GITCLONEDIR=/opt/ITSEC/2.Vulnerability-Scanner/2.Cisco-Tools/copy-router-config/foreni-packages
EXECUTEABLE1=copy-router-config.pl
EXECUTEABLE2=ciscoCPRC
EXECUTEABLE3=merge-router-config.pl
EXECUTEABLE4=ciscoMRC
EXECUTEABLE5=ciscoCPRC.sh
EXECUTEABLE6=ciscoMRC.sh
#ph1b
DSKTPFLS=/opt/ownsec/ITSEC-Install-Scripts-ORIG/2.Vulnerability-Scanner/2.Cisco-Tools/copy-router-config
DSKTPFLSDEST=/home/$USER/.local/share/applications/2.Vulnerability-Scanner/2.Cisco-Tools/copy-router-config
DSKTPFL=copy-router-config.desktop
APTLSTDIR=/opt/ownsec/ITSEC-Install-Scripts-ORIG/2.Vulnerability-Scanner/2.Cisco-Tools/copy-router-config
#ph1a

echo "${bold}
  ____ ____    ____   ___  _   _ _____ _____ ____     ____ ___  _   _ _____ 
 / ___|  _ \  |  _ \ / _ \| | | |_   _| ____|  _ \   / ___/ _ \| \ | |  ___|
| |   | |_) | | |_) | | | | | | | | | |  _| | |_) | | |  | | | |  \| | |_   
| |___|  __/  |  _ <| |_| | |_| | | | | |___|  _ <  | |__| |_| | |\  |  _|  
 \____|_|     |_| \_\\___/ \___/  |_| |_____|_| \_\  \____\___/|_| \_|_|    
             
INSTALL
${normal}"

#plh11
GITCLONEFUNC

### DEPS:

sudo apt-get update
sudo apt-get upgrade
xargs -a <(awk '/^\s*[^#]/' "$APTLSTDIR/deps-copy-router-config.txt") -r -- sudo apt-get install -y
### DEPS END

GITSBMDLINIT
cd Cisco-CopyConfig
perl Makefile.PL
   make -j 4
   make test
sudo make install

GITCLONEFUNC

echo '#!/bin/bash
cd /opt/ITSEC/2.Vulnerability-Scanner/2.Cisco-Tools/copy-router-config/foreni-packages/copy-router-config
perl copy-router-config.pl "$@"' > $EXECUTEABLE5

echo '#!/bin/bash
cd /opt/ITSEC/2.Vulnerability-Scanner/2.Cisco-Tools/copy-router-config/foreni-packages/copy-router-config
perl merge-router-config.pl "$@"' > $EXECUTEABLE6

CHMODXEX1
CHMODXEX3
chmod +x $GITREPOROOT/$EXECUTEABLE5
chmod +x $GITREPOROOT/$EXECUTEABLE6

sudo rm -f $BINDIR/$EXECUTEABLE4
sudo ln -s $GITREPOROOT/$EXECUTEABLE5 $BINDIR/$EXECUTEABLE2
sudo ln -s $GITREPOROOT/$EXECUTEABLE6 $BINDIR/$EXECUTEABLE4
#333d
CPDESKTFL